# 1 为什么python的for循环里不可以改变变量的值?

在python中，for循环相当于一个迭代器（Iterator），在循环体中改变循环变量的值对循环次数是没有影响的。 

迭代器在一个独立的线程中工作，并且拥有一个mutex锁。迭代器被创建的时候，建立了一个内存索引表（单链表），这个索引表指向原来的对象，当原来的对象数量改变的时候，这个索引表的内容没有同步改变，所以当索引指针往下移动的时候，便找不到要迭代的对象，于是产生错误。就是说迭代器在工作的时候，是不允许被迭代的对象被改变的。 

__*为了解决这个问题一般将for loop改为while loop，但是在python中while比for要慢*__

# 2 为什么Python运行速度这么慢？

主要有三个原因：

**1.“它是GIL（Global Interpreter Lock全局解释器锁）”**

当CPython创建变量时，它会预先分配存储空间，然后计算当前变量的引用数目。

这个概念被称为引用计数。如果引用计数为零，那么它将从系统中释放对应存储区域。这就是为什么在CPython中创造“临时”变量不会使应用占用大量的存储空间——尤其是当应用中使用了for循环这一类可能大量创建“临时”变量的结构时。

当存在多个线程调用变量时，CPython如何锁住引用计数成为了一个挑战。而“全局解释锁”应运而生，它能够谨慎控制线程的执行。无论有多少的线程，解释器每次只能执行一个操作。

这对Python的性能意味着难以实现并发

**2.“它是解释型语言而非编译语言”**

这个过程中的重要步骤是在编译阶段创建一个.pyc 文件，这个字节码序列将被写入Python3下__pycache__/ 路径中的一个文件（对于Python2，文件路径相同）。这个步骤不仅仅应用于脚本文件，也应用于所有导入的代码，包括第三方模块。

Python用的是和Java和C#一样的虚拟机和某种字节代码，为什么在基准测试中它却慢得多？首先，.NET和Java是采用JIT编译的。

JIT，又称即时编译，需要一种中间语言来把代码进行分块（或者叫数据帧）。预编译（AOT, Ahead of Time）器的设计保证了CPU能够在交互之前理解代码中的每一行。

为什么CPython不使用即时编译器呢？

JIT存在一些缺点：其中一个是启动时间。CPython启动时间已经相对较慢，PyPy比CPython还要慢2-3倍。众所周知，Java虚拟机的启动速度很慢。为了解决这个问题，.NET CLR在系统启动的时候就开始运行，但CLR的开发人员还开发了专门运行CLR的操作系统来加快它。

**3.“它是动态类型语言”**

​	在静态类型语言中，定义变量时必须声明类型。C, C++, Java, C#, Go都是这种语言。

​	在动态类型语言中，类型的概念依旧存在，但是这个变量的类型是动态变化的。

**综上**

__*Python 之所以缓慢，主要是因为其动态性和多功能性。它可以用作解决各种问题的工具，其中可能有更多的优化和更快的替代方案。*__



